<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>jInvertScroll Demo Page</title>
    <link rel="stylesheet" href="css/example.css" />
</head>
<body>

    <div class="horizon scroll">
        <img src="images/horizon.png" alt="" />
    </div>
    
    <div class="front scroll">
        <!--<img src="images/chemin.png" alt="" />-->
        <div id="ground">
            
        </div>
    </div>
    
    <div class="front perso walk" id="taupe">
        
    </div>
    
    <script type="text/javascript" src="libs/jquery.min.js"></script>
    <script type="text/javascript" src="libs/lodash.js"></script>
    <script type="text/javascript" src="libs/taupe.js"></script>
    <script type="text/javascript" src="libs/ground.js"></script>
    <script type="text/javascript" src="dist/js/jquery.jInvertScroll.js"></script>
    <script type="text/javascript">

        var scenes = {
            start: [0, 0.2],
            2: [0.2, 0.4],
            3: [0.4, 0.6],
            4: [0.6, 1]
        }
        var animations = [
            {
                time: 0.01,
                name: 'animation 1',
                event: function(){
                    console.log('animation 1');
                }
            },
            {
                time: 0.01,
                name: 'animation 1',
                event: function(){
                    console.log('animation 2');
                }
            },
            {
                time: 0.01,
                name: 'animation 1',
                event: function(){
                    console.log('animation 3');
                }
            },
            {
                time: 0.01,
                name: 'animation 1',
                event: function(){
                    console.log('animation 4');
                }
            },
            {
                time: 0.01,
                name: 'animation 1',
                event: function(){
                    console.log('animation 5');
                }
            } 
        ];
        var taupe = new Taupe();
        var ground = new Ground($('#ground'), scenes);
        
        ground.prepare();
        
        var event = new Event('start');
        var event = new Event('1');
        var event = new Event('2');
        var event = new Event('3');

        // Listen for the event.
        window.addEventListener('in-scene-', function (e) {

        }, false);

        function miscAnimate(percent){
            
            var n = parseFloat(percent.toFixed(2));
            _.forEach(animations, function(animation, index){
//                console.log(n, animation);
                if(animation.time === n){
                    animation.event();
                }
            });
        }
        
        (function($) {
            $.jInvertScroll(['.scroll'],{
                height: 60000,                   // optional: define the height the user can scroll, otherwise the overall length will be taken as scrollable height
                onScroll: function(percent) {   //optional: callback function that will be called when the user scrolls down, useful for animating other things on the page
                    console.log("current perent is " + percent);
                    console.log("current scene is " + ground.currentScene);
                    
                    // Set current scene
                    ground.updateScene(parseFloat(percent));

                    // move taupe
                    taupe.move(parseFloat(percent));

                    // throw animation
                    miscAnimate(parseFloat(percent));
                }
            });
        }(jQuery));
        
    </script>
</body>
</html>
